version: '3.8'
# Services -> containerlari tanimlar
services:

   # MariaDB Service
   mariadb:
      container_name: mariadb
      build: ./requirements/mariadb
      env_file:
         - .env
      ports:
         - "3306"
      volumes:
         - MariaDB:/var/lib/mysql
      networks:
         - app-network
      depends_on:
         - wordpress
      restart: always

   # wordpress Service
   wordpress:
      container_name: wordpress
      build: ./requirements/wordpress
      env_file:
         - .env
      ports:
         - "9000"
      depends_on:
         - mariadb
      volumes:
         - Wordpress:/var/www/html
      networks:
         - app-network
      restart: always

   # Nginx Service
   nginx:
      container_name: nginx
      build: ./requirements/nginx
      #image: nginx
      ports:
      - "443:443" #bilgisayarın 443 portu -> container 443 portuna yönlendir.
      depends_on:
         - wordpress
      volumes:
         - Wordpress:/var/www/html
      networks:
         - app-network
      restart: always

# Volumes -> containerlar icin veri kaynaklari
volumes:
   Wordpress:
      driver: local
      driver_opts:
         type: 'none'
         o: bind
         device: '/home/data/wordpress'
   MariaDB:
      driver: local
      driver_opts:
         type: 'none'
         o: bind
         device: '/home/data/mysql'

# Container'lar arasindaki ag baglantilarini tanimlar.
networks:
   app-network:
      driver: bridge
